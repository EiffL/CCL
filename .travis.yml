script:
language: python
python:
  - "2.6"
  - "2.7"
# Travis uses Ubuntu 12.04 and 14.04. None of them have GSL2x in apt-get
# We have to install it from source (this will make the tests slower)
before_install:
  - sudo apt-get -qq update
  - wget ftp://ftp.gnu.org/gnu/gsl/gsl-2.4.tar.gz > gsl-2.4.tar.gz
  - tar -xzvf gsl-2.4.tar.gz
  - pushd gsl-2.4 && ./configure && make && make install
addons:
    apt:
        packages:
            - texlive-latex-recommended
            - texlive-latex-extra
            - texlive-fonts-recommended
            - texlive-fonts-extra
            - dvipng
install: pip install . --egg
script:
    - python setup.py test
    - make -C doc/0000-ccl_note
after_success: |
    if [[ -n "$GITHUB_API_KEY" ]; then
        git checkout --orphan pdf
        git rm -rf .
        cp doc/0000-ccl_note/main.pdf 0000-ccl_note.pdf
        git add -f 0000-ccl_note.pdf
        git -c user.name='travis' -c user.email='travis' commit -m init
        git push -q -f https://drphilmarshall:$GITHUB_API_KEY@github.com/DarkEnergyScienceCollaboration/CCL pdf
    fi
